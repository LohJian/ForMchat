{% extends "base.html" %}
{% block title %}{{ user.username }}'s Profile{% endblock %}

{% block content %}

<style>
  .flash-messages {
    margin-bottom: 20px;
  }

  .alert-success {
    background-color: #d4edda;
    color: #155724;
    border: 1px solid #c3e6cb;
    padding: 10px 15px;
    border-radius: 5px;
    margin-bottom: 10px;
  }

  .alert-error {
    background-color: #f8d7da;
    color: #721c24;
    border: 1px solid #f5c6cb;
    padding: 10px 15px;
    border-radius: 5px;
    margin-bottom: 10px;
  }
</style>

{% with messages = get_flashed_messages(with_categories=true) %}
  {% if messages %}
    <div class="flash-messages">
      {% for category, message in messages %}
        <div class="alert alert-{{ category }}">{{ message }}</div>
      {% endfor %}
    </div>
  {% endif %}
{% endwith %}

<div class="profile-container">
    <div class="profile-header">
        {% if user.avatar and 'default_avatar.jpg' not in user.avatar %}
        <img
            src="{{ url_for('media_files', filename='uploads/user_avatars/' ~ user.avatar) }}"
            class="avatar"
            onerror="this.onerror=null; this.src='{{ url_for('media_files', filename='images/default_avatar.jpg') }}'">
        {% else %}
        <img
            src="{{ url_for('media_files', filename='images/default_avatar.jpg') }}"
            class="avatar">
        {% endif %}
        <h1>{{ user.username }}, {{ user.age }}</h1>
        <p class="location">{{ user.location }}</p>
    </div>

    <div class="interaction-buttons">
        <div class="interaction-btn like-stat">
            <span class="icon">üëç</span>
            <span class="count">{{ like_count }}</span>
            <span class="label">Likes</span>
        </div>
    
        <div class="interaction-btn love-stat">
            <span class="icon">‚ù§Ô∏è</span>
            <span class="count">{{ love_count }}</span>
            <span class="label">Loves</span>
        </div>
    </div>
</div>

<div class="inf-container">
    {% if user.sex %}
    <section class="sex">
        <h2>Gender</h2>
        <p>{{ user.sex }}</p>
    </section>
    {% endif %}

    {% if user.race %}
    <section class="race">
        <h2>Race</h2>
        <p>{{ user.race }}</p>
    </section>
    {% endif %}

    {% if user.faculty %}
    <section class="faculty">
        <h2>Faculty</h2>
        <p>{{ user.faculty }}</p>
    </section>
    {% endif %}

    {% if user.bio %}
    <section class="bio-section">
        <h2>About Me</h2>
        <p>{{ user.bio }}</p>
    </section>
    {% endif %}
</div>

<div class= "contact-container">
    <a href="/edit-profile/{{ user.id }}" class="edit-button">‚úèÔ∏è Edit profile</a>
</div>

{% endblock %}