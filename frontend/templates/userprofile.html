{% extends "base.html" %}
{% block title %}{{ user.username }}的资料页{% endblock %}

{% block content %}

<div class="profile-container">
    <a href="{{ url_for('chat', other_user_id=user.id) }}" style="text-decoration: none;">
        <button style="padding: 10px 20px;">⬅ Return to chatpage</button>
    </a>


    <div class="profile-header">
        {% if user.avatar and 'default_avatar.jpg' not in user.avatar %}
        <img
            src="{{ url_for('media_files', filename='uploads/user_avatars/' ~ user.avatar) }}"
            class="avatar"
            onerror="this.onerror=null; this.src='{{ url_for('media_files', filename='images/default_avatar.jpg') }}'">
        {% else %}
        <img
            src="{{ url_for('media_files', filename='images/default_avatar.jpg') }}"
            class="avatar">
        {% endif %}
        <h1>{{ user.username }}, {{ user.age }}</h1>
        <p class="location">{{ user.location }}</p>
    </div>

    <div class="interaction-buttons">
        <form method="POST" action="{{ url_for('like', user_id=user.id) }}">
            <input type="hidden" name="receiver_id" value="{{ user.id }}">
            <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
            <button type="submit" class="interaction-btn like-btn {% if has_liked %}active{% endif %}" {% if has_liked %}disabled{% endif %}>
                👍 Like ({{ like_count }})
            </button>
        </form>

        <form method="POST" action="{{ url_for('love', user_id=user.id) }}">
            <input type="hidden" name="receiver_id" value="{{ user.id }}">
            <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
            <button type="submit" class="interaction-btn love-btn {% if has_loved %}active{% endif %}" {% if has_loved %}disabled{% endif %}>
                ❤️ Love ({{ love_count }})
            </button>
        </form>
    </div>
    </div>
</div>
</div>
<div class="inf-container">
    {% if user.sex %}
    <section class="sex">
        <h2>Gender</h2>
        <p>{{ user.sex }}</p>
    </section>
    {% endif %}

    {% if user.race %}
    <section class="race">
        <h2>race</h2>
        <p>{{ user.race }}</p>
    </section>
    {% endif %}

    {% if user.faculty %}
    <section class="faculty">
        <h2>faculty</h2>
        <p>{{ user.faculty }}</p>
    </section>
    {% endif %}

    {% if user.bio %}
    <section class="bio-section">
        <h2>About Me</h2>
        <p>{{ user.bio }}</p>
    </section>
    {% endif %}
</div>


{% endblock %}